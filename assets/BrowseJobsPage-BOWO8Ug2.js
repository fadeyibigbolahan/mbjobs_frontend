import{r,j as e,S as U,X as _,a as T,u as B}from"./index-EQ3434Au.js";const Q=()=>{const[y,F]=r.useState([]),[m,L]=r.useState([]),[$,j]=r.useState(!0),[k,R]=r.useState(null),[c,S]=r.useState(""),[u,C]=r.useState("all"),[d,M]=r.useState("all"),[h,A]=r.useState("all"),[b,E]=r.useState("newest"),[P,f]=r.useState(!1),[l,v]=r.useState(null),[p,g]=r.useState(""),[N,D]=r.useState(!1),[w,i]=r.useState(null),W=["all","Technology","Marketing","Data Science","Design","Finance","Healthcare"],H=["all","Lagos","Abuja","Port Harcourt","Ibadan","Kano","Florida","Remote"],I=["all","full-time","part-time","contract","internship"],V=s=>{var t,a,n,o,x;return{id:s._id,title:s.title,company:((t=s.employer)==null?void 0:t.fullName)||"Company Name",location:s.location,type:s.jobType,category:s.category,salary:s.stipend==="Negotiable"?`$${(a=s.salaryMin)==null?void 0:a.toLocaleString()} - $${(n=s.salaryMax)==null?void 0:n.toLocaleString()}`:s.stipend,description:s.description,requirements:s.requirements||[],postedDate:s.createdAt,deadline:s.deadline,logo:"https://fastly.picsum.photos/id/0/5000/3333.jpg?hmac=_j6ghY5fCfSD6tvtcV74zXivkJSPIfR9B8w34XeQmvU",tags:[s.category,s.jobType,s.location].filter(Boolean),isRemote:((o=s.location)==null?void 0:o.toLowerCase().includes("remote"))||!1,experienceLevel:"Entry Level",status:s.status,applicants:((x=s.applicants)==null?void 0:x.length)||0}};r.useEffect(()=>{(async()=>{var a;const t=localStorage.getItem("authToken");try{j(!0);const n=await T.get(`${B}jobs`,{headers:{"Content-Type":"application/json",Authorization:t}});console.log("API Response:",n.data);const o=((a=n.data.jobs)==null?void 0:a.map(V))||[];F(o),L(o),j(!1)}catch(n){console.error("Error fetching jobs:",n),R("Failed to fetch jobs"),j(!1)}})()},[]),r.useEffect(()=>{let s=y;c&&(s=s.filter(t=>t.title.toLowerCase().includes(c.toLowerCase())||t.company.toLowerCase().includes(c.toLowerCase())||t.description.toLowerCase().includes(c.toLowerCase()))),u!=="all"&&(s=s.filter(t=>t.category.toLowerCase()===u.toLowerCase())),d!=="all"&&(s=s.filter(t=>t.location.toLowerCase().includes(d.toLowerCase())||d==="Remote"&&t.isRemote)),h!=="all"&&(s=s.filter(t=>t.type.toLowerCase()===h.toLowerCase())),s.sort((t,a)=>{switch(b){case"newest":return new Date(a.postedDate)-new Date(t.postedDate);case"oldest":return new Date(t.postedDate)-new Date(a.postedDate);case"salary":const n=o=>{const x=o.match(/\d+/g);return x?parseInt(x[0]):0};return n(a.salary)-n(t.salary);case"alphabetical":return t.title.localeCompare(a.title);default:return 0}}),L(s)},[y,c,u,d,h,b]);const q=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),X=s=>{v(s),f(!0),g(""),i(null)},O=async s=>{var a,n;if(s.preventDefault(),!l)return;const t=localStorage.getItem("authToken");if(!t){i({type:"error",message:"Please log in to apply for jobs"});return}D(!0),console.log("selected job",l);try{const o=await T.post(`${B}application/jobs/${l.id}/apply`,{coverLetter:p.trim()},{headers:{"Content-Type":"application/json",Authorization:t}});i({type:"success",message:"Application submitted successfully!"}),setTimeout(()=>{f(!1),v(null),g(""),i(null)},2e3)}catch(o){console.error("Error submitting application:",o),i({type:"error",message:((n=(a=o.response)==null?void 0:a.data)==null?void 0:n.message)||"Failed to submit application"})}finally{D(!1)}},z=()=>{f(!1),v(null),g(""),i(null)};return $?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading jobs..."})]})}):k?e.jsx("div",{className:"p-6 flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[e.jsx("p",{className:"text-red-600",children:k}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Retry"})]})}):e.jsxs("div",{className:"min-h-screen bg-white text-xs",children:[e.jsx("div",{className:"bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto md:px-6",children:[e.jsx("h1",{className:"md:text-3xl text-xl font-bold text-gray-900",children:"Browse Jobs"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Find your next apprenticeship opportunity"})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto md:p-6",children:[e.jsx("div",{className:"rounded-lg shadow-sm my-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"relative flex justify-center items-center gap-2 border p-2 border-gray-300 rounded-lg",children:[e.jsx(U,{className:"w-[20px]"}),e.jsx("input",{type:"text",placeholder:"Search jobs, companies...",className:"w-full pl-10 pr-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:c,onChange:s=>S(s.target.value)})]})}),e.jsx("select",{className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:u,onChange:s=>C(s.target.value),children:W.map(s=>e.jsx("option",{value:s,children:s==="all"?"All Categories":s},s))}),e.jsx("select",{className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d,onChange:s=>M(s.target.value),children:H.map(s=>e.jsx("option",{value:s,children:s==="all"?"All Locations":s},s))}),e.jsx("select",{className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:h,onChange:s=>A(s.target.value),children:I.map(s=>e.jsx("option",{value:s,children:s==="all"?"All Types":s},s))}),e.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:b,onChange:s=>E(s.target.value),children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"salary",children:"Highest Salary"}),e.jsx("option",{value:"alphabetical",children:"A-Z"})]})]})}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("p",{className:"text-gray-600",children:["Showing ",m.length," of ",y.length," jobs"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})}),e.jsx("button",{className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})})]})]}),e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("img",{src:s.logo,alt:`${s.company} logo`,className:"w-12 h-12 rounded-lg object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 hover:text-blue-600 cursor-pointer",children:s.title}),s.isRemote&&e.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:"Remote"}),s.status&&e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${s.status==="Open"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status})]}),e.jsx("p",{className:"text-gray-600 mb-2",children:s.company}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 mb-3",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.location]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.type]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),s.salary]}),s.applicants>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),s.applicants," applicants"]})]}),e.jsx("p",{className:"text-gray-700 mb-3 line-clamp-2",children:s.description}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:s.tags.map((t,a)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:t},a))}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"text-sm text-gray-500",children:["Posted ",q(s.postedDate)," •"]})})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{onClick:()=>X(s),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Apply Now"}),e.jsx("button",{className:"border border-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors",children:"Save Job"})]})]})},s.id))}),m.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No jobs found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search criteria or filters"}),e.jsx("button",{onClick:()=>{S(""),C("all"),M("all"),A("all")},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Clear All Filters"})]}),m.length>0&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("nav",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"px-3 py-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:"Previous"}),e.jsx("button",{className:"px-3 py-2 bg-blue-600 text-white rounded-lg",children:"1"}),e.jsx("button",{className:"px-3 py-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:"2"}),e.jsx("button",{className:"px-3 py-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:"3"}),e.jsx("button",{className:"px-3 py-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:"Next"})]})})]}),P&&l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Apply for Position"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[l.title," at ",l.company]})]}),e.jsx("button",{onClick:z,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(_,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("img",{src:l.logo,alt:`${l.company} logo`,className:"w-12 h-12 rounded-lg object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:l.title}),e.jsx("p",{className:"text-gray-600",children:l.company}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 mt-2",children:[e.jsx("span",{children:l.location}),e.jsx("span",{children:l.type}),e.jsx("span",{children:l.salary})]})]})]})}),e.jsxs("form",{onSubmit:O,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"coverLetter",className:"block text-sm font-medium text-gray-700 mb-2",children:"Cover Letter"}),e.jsx("textarea",{id:"coverLetter",rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Tell us why you're interested in this position and what makes you a great fit...",value:p,onChange:s=>g(s.target.value),required:!0}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[p.length,"/1000 characters"]})]}),w&&e.jsx("div",{className:`mb-4 p-4 rounded-lg ${w.type==="success"?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"}`,children:e.jsx("p",{className:"text-sm font-medium",children:w.message})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:z,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",disabled:N,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:N||!p.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:N?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Submitting..."]}):"Submit Application"})]})]})]})]})})]})};export{Q as default};
